SELECT 
  COALESCE(c1.fundId, c2.fundId) AS fundId,
  COALESCE(c1.positionType, c2.positionType) AS positionType,
  c1.c AS cob1_value,
  c2.c AS cob2_value,
  c2.c - c1.c AS difference,
  CASE 
    WHEN c1.fundId IS NULL THEN 'New in COB2'
    WHEN c2.fundId IS NULL THEN 'Missing in COB2'
    WHEN c1.c != c2.c THEN 'Value changed'
    ELSE 'No change'
  END AS status
FROM cob1 c1
FULL OUTER JOIN cob2 c2 
  ON c1.fundId = c2.fundId 
  AND c1.positionType = c2.positionType
ORDER BY 
  COALESCE(c1.fundId, c2.fundId),
  COALESCE(c1.positionType, c2.positionType);
