import java.util.{Timer, TimerTask}

class DebounceWithoutCommons {
  private var debounceTimer: Timer = _
  private val DEBOUNCE_DELAY: Long = 500 // 防抖延迟500ms

  // 触发防抖任务
  def triggerDebouncedTask(taskParam: String): Unit = {
    // 取消之前的延迟任务（重置防抖）
    if (debounceTimer != null) {
      debounceTimer.cancel()
    }

    // 新定时器延迟执行
    debounceTimer = new Timer()
    debounceTimer.schedule(
      new TimerTask {
        override def run(): Unit = doActualTask(taskParam)
      },
      DEBOUNCE_DELAY
    )
  }

  // 核心业务任务（使用JDK原生时间方法）
  private def doActualTask(param: String): Unit = {
    val currentTime = System.currentTimeMillis()
    println(s"执行防抖任务 | 参数：$param | 时间：$currentTime")
  }
}

// 测试入口
object DebounceWithoutCommonsTest extends App {
  val debounce = new DebounceWithoutCommons()
  
  // 模拟高频触发
  debounce.triggerDebouncedTask("第一次")
  Thread.sleep(200)
  debounce.triggerDebouncedTask("第二次")
  Thread.sleep(300)
  debounce.triggerDebouncedTask("第三次")

  // 等待任务执行
  Thread.sleep(1000)
}
